#include <dpsi_neo_hookean_dF.h>

void dpsi_neo_hookean_dF(Eigen::Vector9d &dw, Eigen::Ref<const Eigen::Matrix3d> F, double C, double D) {
    dw.setZero();
    
    dw(0) = C*(F(0,0)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0-(F(1,1)*F(2,2)-F(1,2)*F(2,1))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))-D*(F(1,1)*F(2,2)-F(1,2)*F(2,1))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(1) = C*(F(1,0)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0+(F(0,1)*F(2,2)-F(0,2)*F(2,1))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))+D*(F(0,1)*F(2,2)-F(0,2)*F(2,1))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(2) = C*(F(2,0)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0-(F(0,1)*F(1,2)-F(0,2)*F(1,1))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))-D*(F(0,1)*F(1,2)-F(0,2)*F(1,1))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(3) = C*(F(0,1)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0+(F(1,0)*F(2,2)-F(1,2)*F(2,0))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))+D*(F(1,0)*F(2,2)-F(1,2)*F(2,0))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(4) = C*(F(1,1)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0-(F(0,0)*F(2,2)-F(0,2)*F(2,0))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))-D*(F(0,0)*F(2,2)-F(0,2)*F(2,0))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(5) = C*(F(2,1)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0+(F(0,0)*F(1,2)-F(0,2)*F(1,0))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))+D*(F(0,0)*F(1,2)-F(0,2)*F(1,0))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(6) = C*(F(0,2)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0-(F(1,0)*F(2,1)-F(1,1)*F(2,0))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))-D*(F(1,0)*F(2,1)-F(1,1)*F(2,0))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(7) = C*(F(1,2)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0+(F(0,0)*F(2,1)-F(0,1)*F(2,0))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))+D*(F(0,0)*F(2,1)-F(0,1)*F(2,0))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
    dw(8) = C*(F(2,2)*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),2.0/3.0)*2.0-(F(0,0)*F(1,1)-F(0,1)*F(1,0))*1.0/pow(F(0,0)*F(1,1)*F(2,2)-F(0,0)*F(1,2)*F(2,1)-F(0,1)*F(1,0)*F(2,2)+F(0,1)*F(1,2)*F(2,0)+F(0,2)*F(1,0)*F(2,1)-F(0,2)*F(1,1)*F(2,0),5.0/3.0)*(F(0,0)*F(0,0)+F(0,1)*F(0,1)+F(0,2)*F(0,2)+F(1,0)*F(1,0)+F(1,1)*F(1,1)+F(1,2)*F(1,2)+F(2,0)*F(2,0)+F(2,1)*F(2,1)+F(2,2)*F(2,2))*(2.0/3.0))-D*(F(0,0)*F(1,1)-F(0,1)*F(1,0))*(-F(0,0)*F(1,1)*F(2,2)+F(0,0)*F(1,2)*F(2,1)+F(0,1)*F(1,0)*F(2,2)-F(0,1)*F(1,2)*F(2,0)-F(0,2)*F(1,0)*F(2,1)+F(0,2)*F(1,1)*F(2,0)+1.0)*2.0;
}